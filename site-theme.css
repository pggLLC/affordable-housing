:root{color-scheme: light;}
    :root{
      --bg-l:#f8fafc; --card-l:#ffffff; --text-l:#0f172a; --muted-l:#475569; --border-l:rgba(15,23,42,.14);
      --bg-d:#0b1220; --card-d:#0f172a; --text-d:#e5e7eb; --muted-d:#a1a1aa; --border-d:rgba(255,255,255,.12);
      --accent:#2563eb; --good:#16a34a; --warn:#d97706; --bad:#dc2626; --focus:#fbbf24;
      --shadow:0 14px 30px rgba(0,0,0,.12);
      --radius:18px;
    }
    :root{--bg:var(--bg-l);--card:var(--card-l);--text:var(--text-l);--muted:var(--muted-l);--border:var(--border-l);}
@media (prefers-color-scheme: light){:root{--bg:var(--bg-l);--card:var(--card-l);--text:var(--text-l);--muted:var(--muted-l);--border:var(--border-l);}}
    @media (prefers-color-scheme: dark){:root{--bg:var(--bg-l);--card:var(--card-l);--text:var(--text-l);--muted:var(--muted-l);--border:var(--border-l);}}}

    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;line-height:1.5;background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased}
    a{color:var(--accent);text-decoration:underline;text-underline-offset:2px}
    a:focus-visible{outline:3px solid var(--focus);outline-offset:3px;border-radius:10px}

    .container{max-width:1160px;margin:0 auto;padding:22px 16px 60px}
    .nav{
      position:sticky;top:0;z-index:50;
      backdrop-filter:saturate(180%) blur(10px);
      background:color-mix(in srgb,var(--bg) 80%, transparent);
      border-bottom:1px solid var(--border);
    }
    .nav-inner{max-width:1160px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:12px 16px;gap:14px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800}
    .brand .dot{width:10px;height:10px;border-radius:999px;background:var(--accent)}
    .links{display:flex;flex-wrap:wrap;gap:10px}
    .links a{color:var(--text);text-decoration:none;padding:8px 10px;border-radius:12px}
    .links a:hover{background:color-mix(in srgb,var(--card) 85%, transparent);border:1px solid var(--border);padding:7px 9px}

    .hero{margin-top:14px}
    .kicker{font-weight:800;letter-spacing:.05em;text-transform:uppercase;color:var(--muted);font-size:.82rem}
    h1{margin:8px 0 10px;font-size:clamp(1.8rem,3.1vw,2.6rem);line-height:1.1}
    .sub{color:var(--muted);max-width:78ch;margin:0}

    .toolbar{margin-top:16px;display:flex;flex-wrap:wrap;gap:10px;align-items:center}
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
    }
    .control{padding:12px 14px;display:flex;gap:10px;align-items:center}
    .control label{font-weight:700}
    .control input{
      width:min(380px,70vw);
      padding:10px 12px;
      border-radius:14px;
      border:1px solid var(--border);
      background:color-mix(in srgb,var(--card) 90%, transparent);
      color:var(--text);
    }
    .btn{
      cursor:pointer;
      border-radius:14px;
      border:1px solid var(--border);
      background:color-mix(in srgb,var(--card) 92%, transparent);
      color:var(--text);
      padding:10px 12px;
      font-weight:800;
    }
    .btn.primary{background:var(--accent);border-color:color-mix(in srgb,var(--accent) 70%, black);color:white}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .status{padding:12px 14px;color:var(--muted)}
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      padding:6px 10px;border-radius:999px;border:1px solid var(--border);
      background:color-mix(in srgb,var(--card) 92%, transparent);
      color:var(--muted);font-weight:700;font-size:.9rem
    }
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px;margin-top:14px}
    .stat{grid-column:span 12;padding:14px}
    .stat .num{font-size:1.6rem;font-weight:900;margin:0}
    .stat .lbl{margin:4px 0 0;color:var(--muted)}
    @media (min-width:860px){.stat{grid-column:span 3}}

    details{margin-top:14px}
    details > summary{
      list-style:none;cursor:pointer;
      padding:14px 16px;
      display:flex;align-items:center;justify-content:space-between;gap:12px;
      font-weight:900;
    }
    details > summary::-webkit-details-marker{display:none}
    .section-body{padding:0 16px 16px}
    .section-desc{color:var(--muted);margin:0 0 12px}

    .metric-grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
    .metric{grid-column:span 12;padding:14px}
    @media (min-width:860px){.metric{grid-column:span 4}}
    .metric h3{margin:0 0 8px;font-size:1rem}
    .metric .value{font-size:1.6rem;font-weight:950;margin:0}
    .metric .meta{margin:6px 0 0;color:var(--muted);display:flex;gap:10px;flex-wrap:wrap}
    .delta{font-weight:900}
    .delta.up{color:var(--good)}
    .delta.down{color:var(--bad)}
    .delta.flat{color:var(--muted)}
    .chart-wrap{margin-top:10px;border-top:1px solid var(--border);padding-top:10px}
    canvas{width:100% !important;height:180px !important}

    .note{margin-top:18px;color:var(--muted);font-size:.95rem}
    .small{font-size:.9rem}
    .err{color:var(--bad);font-weight:800}
/* Ensure readable defaults */
html,body{background:var(--bg)!important;color:var(--text)!important}
a{color:var(--accent)}
a:hover{filter:brightness(0.95)}
/* Prevent illegible utility combos */
.muted{color:var(--muted)!important}
/* Shared navigation + footer styles */
header.nav{position:sticky;top:0;z-index:1000;background:var(--card);border-bottom:1px solid var(--border);backdrop-filter:saturate(140%) blur(10px)}
.nav-inner{max-width:1100px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:14px 18px;gap:14px}
.brand{display:flex;align-items:center;gap:10px;font-weight:800;letter-spacing:.2px}
.brand .dot{width:10px;height:10px;border-radius:999px;background:var(--accent);display:inline-block}
nav.links{display:flex;gap:14px;flex-wrap:wrap}
nav.links a{color:var(--muted);text-decoration:none;font-weight:650;padding:8px 10px;border-radius:10px}
nav.links a:hover{color:var(--text);background:rgba(37,99,235,.08)}
nav.links a[aria-current="page"]{color:var(--text);background:rgba(37,99,235,.12)}

.site-footer{border-top:1px solid var(--border);margin-top:36px;background:var(--card)}
.site-footer .inner{max-width:1100px;margin:0 auto;padding:22px 18px;display:grid;grid-template-columns:1.2fr .9fr .9fr;gap:18px}
.site-footer .tagline{color:var(--muted);line-height:1.5}
.site-footer h4{margin:0 0 10px 0;font-size:13px;letter-spacing:.14em;text-transform:uppercase;color:var(--muted)}
.site-footer a{color:var(--muted);text-decoration:none}
.site-footer a:hover{color:var(--text);text-decoration:underline}
@media (max-width:820px){.site-footer .inner{grid-template-columns:1fr}}


/* Compatibility aliases (legacy pages) */
:root{
  --bg-primary: var(--bg);
  --bg-secondary: color-mix(in oklab, var(--bg) 70%, var(--card) 30%);
  --text-primary: var(--text);
  --text-secondary: var(--muted);
  --accent-gold: var(--accent);
}

/* Layout tightening */
main{min-height:calc(100vh - 160px)}
.section, .content-section{margin:16px 0}
.hero, .hero-section{padding:2.5rem 1.25rem !important}
.container{max-width:1200px;margin:0 auto;padding:0 18px}


/* Stat card source line */
.card.stat .src{margin:6px 0 0 0;font-size:.82rem;color:var(--muted)}
.card.stat .src a{color:var(--muted);text-decoration:underline;text-underline-offset:2px}
.card.stat .src a:hover{color:var(--text)}

/* Census controls */
#census-stats{margin:18px 0;padding:18px}
.census-controls{display:flex;flex-wrap:wrap;gap:12px;align-items:flex-end;justify-content:space-between}
.census-controls label{display:flex;flex-direction:column;gap:6px;font-weight:800;color:var(--muted);font-size:.85rem}
.census-controls select{min-width:220px}
.census-vintage{margin-left:auto;color:var(--muted);font-weight:800}
.census-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px;margin-top:12px}
.census-grid .card{padding:14px}

/* === Dark Professional Defaults (auto-applied) === */
:root {
  --bg: #0b0f14;
  --bg-2: #0f1620;
  --surface: #111a24;
  --surface-2: #0e141d;
  --border: rgba(255,255,255,0.10);
  --text: rgba(255,255,255,0.92);
  --muted: rgba(255,255,255,0.70);
  --link: rgba(180,210,255,0.95);

  /* tighter typography + spacing */
  --font-base: 14px;
  --line: 1.45;
  --h1: 1.75rem;
  --h2: 1.25rem;
  --h3: 1.05rem;

  --space-1: 0.35rem;
  --space-2: 0.6rem;
  --space-3: 0.9rem;
  --space-4: 1.2rem;
  --space-5: 1.6rem;
}

html, body {
  background: var(--bg) !important;
  color: var(--text) !important;
  font-size: var(--font-base) !important;
  line-height: var(--line) !important;
}

body {
  margin: 0;
}

main {
  background: transparent !important;
}

a {
  color: var(--link) !important;
}

p, li, td, th, .muted, .subtle, .stat-label {
  color: var(--muted) !important;
}

h1, h2, h3, h4, h5, h6,
.stat-value, .kpi-value {
  color: var(--text) !important;
}

h1 { font-size: var(--h1) !important; margin: 0 0 var(--space-3) 0 !important; }
h2 { font-size: var(--h2) !important; margin: 0 0 var(--space-2) 0 !important; }
h3 { font-size: var(--h3) !important; margin: 0 0 var(--space-2) 0 !important; }

/* Neutralize stray light/white sections from legacy CSS */
header, footer, section, .section, .page, .content, .container, .wrap {
  background: transparent !important;
}

.card, .kpi-card, .panel, .tile, .box, .callout, .content-card {
  background: var(--surface) !important;
  border: 1px solid var(--border) !important;
  border-radius: 14px;
}

.table, table {
  background: transparent !important;
  color: var(--text) !important;
}

table th, table td {
  border-color: var(--border) !important;
}

/* tighter layout to remove dead space */
.section, section { padding-top: var(--space-4) !important; padding-bottom: var(--space-4) !important; }
.hero, .masthead, .page-hero { padding-top: var(--space-5) !important; padding-bottom: var(--space-5) !important; }
.container, .wrap { padding-left: var(--space-4) !important; padding-right: var(--space-4) !important; }
main > :first-child { margin-top: var(--space-3) !important; }
main > :last-child { margin-bottom: var(--space-4) !important; }

hr { border-color: var(--border) !important; }

/* form controls */
select, input, textarea {
  background: var(--surface-2) !important;
  color: var(--text) !important;
  border: 1px solid var(--border) !important;
}

/* === Page-specific legibility fixes === */
/* Fix illegible legacy sections that set dark-on-dark or light-on-light */
body[data-page="colorado-deep-dive.html"] .card,
body[data-page="insights.html"] .card,
body[data-page="article-pricing.html"] .card,
body[data-page="colorado-market.html"] .card,
body[data-page="cra-expansion-analysis.html"] .card,
body[data-page="colorado-deep-dive.html"] .content-card,
body[data-page="insights.html"] .content-card,
body[data-page="article-pricing.html"] .content-card,
body[data-page="colorado-market.html"] .content-card,
body[data-page="cra-expansion-analysis.html"] .content-card,
body[data-page="colorado-deep-dive.html"] .panel,
body[data-page="insights.html"] .panel,
body[data-page="article-pricing.html"] .panel,
body[data-page="colorado-market.html"] .panel,
body[data-page="cra-expansion-analysis.html"] .panel,
body[data-page="colorado-deep-dive.html"] .tile,
body[data-page="insights.html"] .tile,
body[data-page="article-pricing.html"] .tile,
body[data-page="colorado-market.html"] .tile,
body[data-page="cra-expansion-analysis.html"] .tile {
  background: var(--surface) !important;
  color: var(--text) !important;
}

body[data-page="colorado-deep-dive.html"] p,
body[data-page="insights.html"] p,
body[data-page="article-pricing.html"] p,
body[data-page="colorado-market.html"] p,
body[data-page="cra-expansion-analysis.html"] p,
body[data-page="colorado-deep-dive.html"] li,
body[data-page="insights.html"] li,
body[data-page="article-pricing.html"] li,
body[data-page="colorado-market.html"] li,
body[data-page="cra-expansion-analysis.html"] li,
body[data-page="colorado-deep-dive.html"] td,
body[data-page="insights.html"] td,
body[data-page="article-pricing.html"] td,
body[data-page="colorado-market.html"] td,
body[data-page="cra-expansion-analysis.html"] td {
  color: var(--muted) !important;
}

body[data-page="colorado-deep-dive.html"] h1,
body[data-page="insights.html"] h1,
body[data-page="article-pricing.html"] h1,
body[data-page="colorado-market.html"] h1,
body[data-page="cra-expansion-analysis.html"] h1,
body[data-page="colorado-deep-dive.html"] h2,
body[data-page="insights.html"] h2,
body[data-page="article-pricing.html"] h2,
body[data-page="colorado-market.html"] h2,
body[data-page="cra-expansion-analysis.html"] h2,
body[data-page="colorado-deep-dive.html"] h3,
body[data-page="insights.html"] h3,
body[data-page="article-pricing.html"] h3,
body[data-page="colorado-market.html"] h3,
body[data-page="cra-expansion-analysis.html"] h3 {
  color: var(--text) !important;
}

/* tables and code blocks that sometimes inherit light backgrounds */
body[data-page="colorado-deep-dive.html"] table,
body[data-page="insights.html"] table,
body[data-page="article-pricing.html"] table,
body[data-page="colorado-market.html"] table,
body[data-page="cra-expansion-analysis.html"] table,
body[data-page="colorado-deep-dive.html"] pre,
body[data-page="insights.html"] pre,
body[data-page="article-pricing.html"] pre,
body[data-page="colorado-market.html"] pre,
body[data-page="cra-expansion-analysis.html"] pre,
body[data-page="colorado-deep-dive.html"] code,
body[data-page="insights.html"] code,
body[data-page="article-pricing.html"] code,
body[data-page="colorado-market.html"] code,
body[data-page="cra-expansion-analysis.html"] code {
  background: var(--surface-2) !important;
  color: var(--text) !important;
  border-color: var(--border) !important;
}

/* Reduce dead space between text blocks on specific pages */
body[data-page="insights.html"] p,
body[data-page="housing-legislation-2026.html"] p {
  margin-top: 0.45rem !important;
  margin-bottom: 0.55rem !important;
}
body[data-page="insights.html"] h2,
body[data-page="housing-legislation-2026.html"] h2 {
  margin-top: 1.0rem !important;
  margin-bottom: 0.55rem !important;
}
body[data-page="insights.html"] h3,
body[data-page="housing-legislation-2026.html"] h3 {
  margin-top: 0.85rem !important;
  margin-bottom: 0.45rem !important;
}
body[data-page="insights.html"] ul,
body[data-page="housing-legislation-2026.html"] ul,
body[data-page="insights.html"] ol,
body[data-page="housing-legislation-2026.html"] ol {
  margin-top: 0.45rem !important;
  margin-bottom: 0.65rem !important;
}



/* === Leaflet dark tooltip tweaks === */
.leaflet-tooltip {
  background: rgba(15,22,32,0.92) !important;
  color: rgba(255,255,255,0.92) !important;
  border: 1px solid rgba(255,255,255,0.14) !important;
  box-shadow: 0 6px 20px rgba(0,0,0,0.35) !important;
}
.leaflet-popup-content-wrapper, .leaflet-popup-tip {
  background: rgba(17,26,36,0.98) !important;
  color: rgba(255,255,255,0.92) !important;
}
